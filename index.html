<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üëë –ú–∞—à–∏–Ω–∞ –í—Ä–µ–º–µ–Ω–∏</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ –ü–ï–†–í–´–ú! -->
    <script src="config.js"></script>
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    
    <style>
        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ */
        .mode-badge {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            z-index: 10;
        }
        
        .mode-api {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            box-shadow: 0 3px 10px rgba(46, 204, 113, 0.3);
        }
        
        .mode-demo {
            background: linear-gradient(135deg, #f39c12, #e67e22);
            color: white;
            box-shadow: 0 3px 10px rgba(243, 156, 18, 0.3);
        }
        
        .mode-error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
            box-shadow: 0 3px 10px rgba(231, 76, 60, 0.3);
        }
        
        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .settings-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            z-index: 10;
            transition: all 0.3s ease;
        }
        
        .settings-btn:hover {
            background: rgba(52, 152, 219, 0.3);
            border-color: #3498db;
        }
    </style>
</head>
<body>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞ (–∑–∞–ø–æ–ª–Ω–∏—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º) -->
    <div id="modeIndicator" class="mode-badge">
        <i class="fas fa-spinner fa-spin"></i>
        <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
    </div>
    
    <!-- –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
    <button id="settingsBtn" class="settings-btn" style="display: none;">
        <i class="fas fa-cog"></i>
        <span>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
    </button>

    <div class="container">
        <!-- –®–∞–ø–∫–∞ -->
        <header class="header">
            <h1><i class="fas fa-crown"></i> –ú–∞—à–∏–Ω–∞ –í—Ä–µ–º–µ–Ω–∏</h1>
            <p class="subtitle">‚ú® –ó–∞–¥–∞–π –≤–æ–ø—Ä–æ—Å –≤–µ–ª–∏–∫–∏–º –ø—Ä–∞–≤–∏—Ç–µ–ª—è–º –†–æ—Å—Å–∏–∏!</p>
            
            <!-- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
            <div class="status-info">
                <div class="status-item">
                    <span class="status-label">–†–µ–∂–∏–º:</span>
                    <span id="modeStatus" class="status-value">–ü—Ä–æ–≤–µ—Ä–∫–∞...</span>
                </div>
                <div class="status-item">
                    <span class="status-label">API:</span>
                    <span id="apiStatus" class="status-value">‚è≥ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è...</span>
                </div>
            </div>
        </header>

        <div class="main-content">
            <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å - –≤—ã–±–æ—Ä –ø—Ä–∞–≤–∏—Ç–µ–ª—è -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-users"></i> –í—ã–±–µ—Ä–∏ —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞</h2>
                    <div class="divider"></div>
                </div>

                <div class="rulers-grid">
                    <!-- –ò–≤–∞–Ω –ì—Ä–æ–∑–Ω—ã–π -->
                    <div class="ruler-card" data-ruler="ivan">
                        <div class="ruler-avatar">üëë</div>
                        <h3>–ò–≤–∞–Ω IV –ì—Ä–æ–∑–Ω—ã–π</h3>
                        <p class="ruler-desc">–ü–µ—Ä–≤—ã–π —Ü–∞—Ä—å –≤—Å–µ—è –†—É—Å–∏</p>
                        <button class="select-btn" data-ruler="ivan">
                            <i class="fas fa-forward"></i> –í–ø–µ—Ä–µ–¥
                        </button>
                    </div>

                    <!-- –ü–µ—Ç—Ä I -->
                    <div class="ruler-card" data-ruler="petr">
                        <div class="ruler-avatar">üßî</div>
                        <h3>–ü–µ—Ç—Ä I –í–µ–ª–∏–∫–∏–π</h3>
                        <p class="ruler-desc">–¶–∞—Ä—å-—Ä–µ—Ñ–æ—Ä–º–∞—Ç–æ—Ä</p>
                        <button class="select-btn" data-ruler="petr">
                            <i class="fas fa-forward"></i> –í–ø–µ—Ä–µ–¥
                        </button>
                    </div>

                    <!-- –ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ II -->
                    <div class="ruler-card" data-ruler="ekaterina">
                        <div class="ruler-avatar">üë∏</div>
                        <h3>–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ II</h3>
                        <p class="ruler-desc">–ò–º–ø–µ—Ä–∞—Ç—Ä–∏—Ü–∞-–ø—Ä–æ—Å–≤–µ—Ç–∏—Ç–µ–ª—å–Ω–∏—Ü–∞</p>
                        <button class="select-btn" data-ruler="ekaterina">
                            <i class="fas fa-forward"></i> –í–ø–µ—Ä–µ–¥
                        </button>
                    </div>
                </div>

                <div class="sidebar-info">
                    <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∂–∏–º–µ -->
                    <div id="modeInfo" class="mode-info-box" style="display: none;">
                        <h4><i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∂–∏–º–µ</h4>
                        <p id="modeDescription">–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</p>
                    </div>
                    
                    <div class="tip-box">
                        <h3><i class="fas fa-lightbulb"></i> –°–æ–≤–µ—Ç</h3>
                        <p>–°–ø—Ä–æ—Å–∏ –æ —Ä–µ—Ñ–æ—Ä–º–∞—Ö, –≤–æ–π–Ω–∞—Ö, –Ω–∞—É–∫–∞—Ö –∏–ª–∏ –∂–∏–∑–Ω–∏ —Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏!</p>
                    </div>
                    
                    <div class="examples">
                        <h4>–ü—Ä–∏–º–µ—Ä—ã –≤–æ–ø—Ä–æ—Å–æ–≤:</h4>
                        <ul>
                            <li><i class="fas fa-chevron-right"></i> –ó–∞—á–µ–º –≤–≤–µ–ª–∏ –æ–ø—Ä–∏—á–Ω–∏–Ω—É?</li>
                            <li><i class="fas fa-chevron-right"></i> –ü–æ—á–µ–º—É —Ä—É–±–∏–ª–∏ –±–æ—Ä–æ–¥—ã?</li>
                            <li><i class="fas fa-chevron-right"></i> –ß—Ç–æ —Ç–∞–∫–æ–µ –ø—Ä–æ—Å–≤–µ—â–µ–Ω–Ω—ã–π –∞–±—Å–æ–ª—é—Ç–∏–∑–º?</li>
                        </ul>
                    </div>

                    <!-- –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è -->
                    <div class="control-panel">
                        <h4><i class="fas fa-sliders-h"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</h4>
                        <div class="control-buttons">
                            <button id="testApiBtn" class="control-btn">
                                <i class="fas fa-vial"></i> –¢–µ—Å—Ç API
                            </button>
                            <button id="clearStorageBtn" class="control-btn">
                                <i class="fas fa-broom"></i> –û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
                            </button>
                            <button id="reloadBtn" class="control-btn">
                                <i class="fas fa-redo"></i> –û–±–Ω–æ–≤–∏—Ç—å
                            </button>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- –û—Å–Ω–æ–≤–Ω–∞—è –æ–±–ª–∞—Å—Ç—å - —á–∞—Ç -->
            <main class="chat-area">
                <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫—Ä–∞–Ω -->
                <div id="welcome-screen" class="welcome-screen">
                    <div class="welcome-content">
                        <div class="welcome-icon">üï∞Ô∏è</div>
                        <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ú–∞—à–∏–Ω—É –í—Ä–µ–º–µ–Ω–∏!</h2>
                        
                        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ -->
                        <div id="connectionInfo" class="connection-info">
                            <div class="connection-status">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –Ø–Ω–¥–µ–∫—Å GPT...</span>
                            </div>
                        </div>
                        
                        <div class="features">
                            <div class="feature">
                                <i class="fas fa-user-crown"></i>
                                <h3>–û–±—â–∞–π—Å—è —Å –ø—Ä–∞–≤–∏—Ç–µ–ª—è–º–∏</h3>
                                <p>–õ–∏—á–Ω–æ –ø–æ–≥–æ–≤–æ—Ä–∏ —Å –ò–≤–∞–Ω–æ–º –ì—Ä–æ–∑–Ω—ã–º, –ü–µ—Ç—Ä–æ–º I –∏ –ï–∫–∞—Ç–µ—Ä–∏–Ω–æ–π II</p>
                            </div>
                            
                            <div class="feature">
                                <i class="fas fa-graduation-cap"></i>
                                <h3>–ò–∑—É—á–∞–π –∏—Å—Ç–æ—Ä–∏—é</h3>
                                <p>–£–∑–Ω–∞–≤–∞–π –∏—Å—Ç–æ—Ä–∏—é —á–µ—Ä–µ–∑ –∂–∏–≤—ã–µ –¥–∏–∞–ª–æ–≥–∏</p>
                            </div>
                            
                            <div class="feature">
                                <i class="fas fa-comments"></i>
                                <h3>–ó–∞–¥–∞–≤–∞–π –≤–æ–ø—Ä–æ—Å—ã</h3>
                                <p>–ü–æ–ª—É—á–∞–π –æ—Ç–≤–µ—Ç—ã –≤ —É–Ω–∏–∫–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∞–≤–∏—Ç–µ–ª—è</p>
                            </div>
                        </div>
                        
                        <div class="instruction">
                            <p><i class="fas fa-hand-point-left"></i> <strong>–ö–∞–∫ –Ω–∞—á–∞—Ç—å:</strong> –í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏—Ç–µ–ª—è —Å–ª–µ–≤–∞ –∏ –∑–∞–¥–∞–π –µ–º—É –≤–æ–ø—Ä–æ—Å!</p>
                        </div>
                        
                        <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç API -->
                        <div id="noApiWarning" class="warning-box" style="display: none;">
                            <h4><i class="fas fa-exclamation-triangle"></i> –í–Ω–∏–º–∞–Ω–∏–µ!</h4>
                            <p>–Ø–Ω–¥–µ–∫—Å GPT –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º —Å –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏.</p>
                            <button id="setupApiBtn" class="warning-btn">
                                <i class="fas fa-key"></i> –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API
                            </button>
                        </div>
                    </div>
                </div>

                <!-- –≠–∫—Ä–∞–Ω —á–∞—Ç–∞ (—Å–∫—Ä—ã—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) -->
                <div id="chat-screen" class="chat-screen" style="display: none;">
                    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ -->
                    <div class="chat-header">
                        <div class="current-ruler">
                            <span id="current-avatar">üëë</span>
                            <div>
                                <h2 id="current-ruler-name">–ò–≤–∞–Ω IV –ì—Ä–æ–∑–Ω—ã–π</h2>
                                <p id="current-ruler-desc" class="ruler-description"></p>
                            </div>
                        </div>
                        <div class="chat-controls">
                            <button id="backBtn" class="control-btn small">
                                <i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥
                            </button>
                            <button id="clear-chat" class="clear-btn">
                                <i class="fas fa-trash"></i> –û—á–∏—Å—Ç–∏—Ç—å —á–∞—Ç
                            </button>
                        </div>
                    </div>

                    <!-- –ò—Å—Ç–æ—Ä–∏—è —á–∞—Ç–∞ -->
                    <div id="chat-history" class="chat-history">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>

                    <!-- –§–æ—Ä–º–∞ –≤–≤–æ–¥–∞ –≤–æ–ø—Ä–æ—Å–∞ -->
                    <div class="input-area">
                        <textarea 
                            id="question-input" 
                            placeholder="–ù–∞–ø–∏—à–∏ —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å –ø—Ä–∞–≤–∏—Ç–µ–ª—é... –ù–∞–ø—Ä–∏–º–µ—Ä: –ó–∞—á–µ–º –í—ã –≤–≤–µ–ª–∏ –æ–ø—Ä–∏—á–Ω–∏–Ω—É?"
                            rows="3"
                            maxlength="500"
                        ></textarea>
                        <div class="input-controls">
                            <div class="char-count">
                                <span id="char-count">0</span>/500
                            </div>
                            <button id="send-btn" class="send-btn">
                                <i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ–ø—Ä–æ—Å
                            </button>
                        </div>
                        <div class="mode-hint" id="modeHint">
                            <i class="fas fa-info-circle"></i>
                            <span>–†–µ–∂–∏–º: <span id="currentModeText">–¥–µ–º–æ</span></span>
                        </div>
                    </div>

                    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
                    <div id="loading" class="loading" style="display: none;">
                        <div class="spinner"></div>
                        <p id="loading-text">–ü—Ä–∞–≤–∏—Ç–µ–ª—å –æ–±–¥—É–º—ã–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç...</p>
                    </div>
                </div>
            </main>
        </div>

        <!-- –§—É—Ç–µ—Ä -->
        <footer class="footer">
            <p>
                <i class="fas fa-crown"></i> –ú–∞—à–∏–Ω–∞ –í—Ä–µ–º–µ–Ω–∏ ‚Ä¢ 
                –£–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –∏–∑—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –†–æ—Å—Å–∏–∏ ‚Ä¢ 
                <span id="current-year"></span> ‚Ä¢ 
                <a href="https://github.com" target="_blank" class="github-link">
                    <i class="fab fa-github"></i> GitHub Pages
                </a>
            </p>
            <p class="footer-note">
                <small id="footerNote">–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º. –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ò–ò –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å GPT.</small>
            </p>
        </footer>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–∫ API -->
    <div id="apiSettingsModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" data-modal="api">&times;</span>
            <h3><i class="fas fa-key"></i> –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ø–Ω–¥–µ–∫—Å GPT</h3>
            
            <div class="api-instructions">
                <p>–î–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ä–µ–∞–ª—å–Ω—ã–º –ò–ò –Ω—É–∂–Ω—ã –∫–ª—é—á–∏ –æ—Ç <a href="https://cloud.yandex.ru" target="_blank">–Ø–Ω–¥–µ–∫—Å –û–±–ª–∞–∫–∞</a>:</p>
                
                <div class="api-fields">
                    <div class="field">
                        <label for="apiKeyInput">
                            <i class="fas fa-key"></i> API Key:
                        </label>
                        <input type="password" id="apiKeyInput" 
                               placeholder="AQVN..." 
                               value="">
                        <small class="field-hint">–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å AQVN...</small>
                    </div>
                    
                    <div class="field">
                        <label for="folderIdInput">
                            <i class="fas fa-folder"></i> Folder ID:
                        </label>
                        <input type="text" id="folderIdInput" 
                               placeholder="b1g..." 
                               value="">
                        <small class="field-hint">–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å b1g...</small>
                    </div>
                </div>
                
                <div class="api-test-area">
                    <button id="testConnectionBtn" class="test-btn">
                        <i class="fas fa-vial"></i> –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                    </button>
                    <div id="testResult" class="test-result"></div>
                </div>
                
                <div class="api-info-box">
                    <h4><i class="fas fa-question-circle"></i> –ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á–∏:</h4>
                    <ol>
                        <li>–ó–∞–π–¥–∏—Ç–µ –Ω–∞ <a href="https://cloud.yandex.ru" target="_blank">cloud.yandex.ru</a></li>
                        <li>–°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ä–≤–∏—Å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç</li>
                        <li>–í—ã–¥–∞–π—Ç–µ –ø—Ä–∞–≤–∞ <code>ai.languageModels.user</code></li>
                        <li>–°–æ–∑–¥–∞–π—Ç–µ API –∫–ª—é—á</li>
                        <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Folder ID –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞—Ç–∞–ª–æ–≥–∞</li>
                    </ol>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button id="saveApiConfigBtn" class="modal-btn primary">
                    <i class="fas fa-save"></i> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
                </button>
                <button id="useDemoBtn" class="modal-btn secondary">
                    <i class="fas fa-theater-masks"></i> –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–º–æ-—Ä–µ–∂–∏–º
                </button>
                <button id="cancelApiBtn" class="modal-btn">
                    –û—Ç–º–µ–Ω–∞
                </button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ -->
    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" data-modal="info">&times;</span>
            <h3><i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
            <div id="infoContent">
                <p>–ó–∞–≥—Ä—É–∑–∫–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏...</p>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn" data-modal="info">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ç–µ—Å—Ç–∞ -->
    <div id="testModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" data-modal="test">&times;</span>
            <h3><i class="fas fa-vial"></i> –†–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–∞</h3>
            <div id="testContent">
                <div class="test-spinner">
                    <div class="spinner"></div>
                    <p>–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...</p>
                </div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn" data-modal="test">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="script.js"></script>
    
    <!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∫–æ–Ω—Ñ–∏–≥–æ–º –∏ UI -->
    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ñ–∏–≥–∞
        function updateUIFromConfig() {
            const config = window.CONFIG || {};
            const mode = config.MODE || 'demo';
            const hasApiKey = config.YANDEX_API_KEY && 
                            !config.YANDEX_API_KEY.includes('–≤–∞—à_–∫–ª—é—á') && 
                            config.YANDEX_API_KEY.length > 10;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ä–µ–∂–∏–º–∞
            const modeIndicator = document.getElementById('modeIndicator');
            const modeStatus = document.getElementById('modeStatus');
            const apiStatus = document.getElementById('apiStatus');
            const modeHint = document.getElementById('modeHint');
            const currentModeText = document.getElementById('currentModeText');
            const footerNote = document.getElementById('footerNote');
            const noApiWarning = document.getElementById('noApiWarning');
            const settingsBtn = document.getElementById('settingsBtn');
            
            if (mode === 'api' && hasApiKey) {
                // –†–µ–∂–∏–º API —Ä–∞–±–æ—Ç–∞–µ—Ç
                modeIndicator.className = 'mode-badge mode-api';
                modeIndicator.innerHTML = '<i class="fas fa-robot"></i><span>–Ø–Ω–¥–µ–∫—Å GPT</span>';
                modeStatus.textContent = '–Ø–Ω–¥–µ–∫—Å GPT';
                apiStatus.innerHTML = '<span style="color:#2ecc71">‚úÖ –î–æ—Å—Ç—É–ø–µ–Ω</span>';
                currentModeText.textContent = '–Ø–Ω–¥–µ–∫—Å GPT';
                footerNote.textContent = '–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ø–Ω–¥–µ–∫—Å GPT (—Ä–µ–∞–ª—å–Ω—ã–π –ò–ò)';
                noApiWarning.style.display = 'none';
                modeHint.style.display = 'flex';
                settingsBtn.style.display = 'flex';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞
                const modeDescription = document.getElementById('modeDescription');
                if (modeDescription) {
                    modeDescription.textContent = '–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –Ø–Ω–¥–µ–∫—Å GPT. –í—Å–µ –æ—Ç–≤–µ—Ç—ã –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç—Å—è –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º.';
                }
                
            } else {
                // –î–µ–º–æ-—Ä–µ–∂–∏–º
                modeIndicator.className = 'mode-badge mode-demo';
                modeIndicator.innerHTML = '<i class="fas fa-theater-masks"></i><span>–î–µ–º–æ-—Ä–µ–∂–∏–º</span>';
                modeStatus.textContent = '–î–µ–º–æ-—Ä–µ–∂–∏–º';
                apiStatus.innerHTML = '<span style="color:#f39c12">üé≠ –î–µ–º–æ</span>';
                currentModeText.textContent = '–¥–µ–º–æ';
                footerNote.textContent = '–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º. –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ò–ò –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å GPT.';
                noApiWarning.style.display = 'block';
                modeHint.style.display = 'flex';
                settingsBtn.style.display = 'flex';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞
                const modeDescription = document.getElementById('modeDescription');
                if (modeDescription) {
                    modeDescription.textContent = '–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º —Å –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏. –î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ò–ò –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –Ø–Ω–¥–µ–∫—Å GPT.';
                }
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–µ–∂–∏–º–µ
            const modeInfo = document.getElementById('modeInfo');
            if (modeInfo) {
                modeInfo.style.display = 'block';
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ API
        async function checkApiConnection() {
            const connectionInfo = document.getElementById('connectionInfo');
            if (!connectionInfo) return;
            
            const config = window.CONFIG || {};
            const hasApiKey = config.YANDEX_API_KEY && 
                            !config.YANDEX_API_KEY.includes('–≤–∞—à_–∫–ª—é—á') && 
                            config.YANDEX_API_KEY.length > 10;
            
            if (config.MODE === 'api' && hasApiKey) {
                connectionInfo.innerHTML = `
                    <div class="connection-status checking">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –Ø–Ω–¥–µ–∫—Å GPT...</span>
                    </div>
                `;
                
                // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É (—Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—É–¥–µ—Ç –≤ script.js)
                setTimeout(() => {
                    connectionInfo.innerHTML = `
                        <div class="connection-status success">
                            <i class="fas fa-check-circle"></i>
                            <span>‚úÖ –Ø–Ω–¥–µ–∫—Å GPT –¥–æ—Å—Ç—É–ø–µ–Ω!</span>
                        </div>
                    `;
                }, 1500);
            } else {
                connectionInfo.innerHTML = `
                    <div class="connection-status demo">
                        <i class="fas fa-theater-masks"></i>
                        <span>üé≠ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ–º–æ-—Ä–µ–∂–∏–º</span>
                    </div>
                `;
            }
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
        function setupModalHandlers() {
            // –ö–Ω–æ–ø–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            const settingsBtn = document.getElementById('settingsBtn');
            const apiSettingsModal = document.getElementById('apiSettingsModal');
            
            if (settingsBtn && apiSettingsModal) {
                settingsBtn.addEventListener('click', () => {
                    // –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–æ–ª—è —Ç–µ–∫—É—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
                    const config = window.CONFIG || {};
                    document.getElementById('apiKeyInput').value = config.YANDEX_API_KEY || '';
                    document.getElementById('folderIdInput').value = config.YANDEX_FOLDER_ID || '';
                    
                    apiSettingsModal.style.display = 'flex';
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    const modal = this.closest('.modal');
                    if (modal) {
                        modal.style.display = 'none';
                    }
                });
            });
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ –æ–∫–Ω–∞
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
            
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞—Å—Ç—Ä–æ–∏—Ç—å API"
            const setupApiBtn = document.getElementById('setupApiBtn');
            if (setupApiBtn && apiSettingsModal) {
                setupApiBtn.addEventListener('click', () => {
                    apiSettingsModal.style.display = 'flex';
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–¢–µ—Å—Ç API"
            const testApiBtn = document.getElementById('testApiBtn');
            if (testApiBtn) {
                testApiBtn.addEventListener('click', () => {
                    if (typeof window.testAPI === 'function') {
                        window.testAPI();
                    } else {
                        alert('–§—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è API –¥–æ—Å—Ç—É–ø–Ω–∞ –ø–æ—Å–ª–µ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã');
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ"
            const clearStorageBtn = document.getElementById('clearStorageBtn');
            if (clearStorageBtn) {
                clearStorageBtn.addEventListener('click', () => {
                    if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏—Å—Ç–æ—Ä–∏—é —á–∞—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)?')) {
                        localStorage.clear();
                        sessionStorage.clear();
                        alert('–î–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞.');
                        setTimeout(() => location.reload(), 1000);
                    }
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å"
            const reloadBtn = document.getElementById('reloadBtn');
            if (reloadBtn) {
                reloadBtn.addEventListener('click', () => {
                    location.reload();
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–ù–∞–∑–∞–¥" –≤ —á–∞—Ç–µ
            const backBtn = document.getElementById('backBtn');
            const welcomeScreen = document.getElementById('welcome-screen');
            const chatScreen = document.getElementById('chat-screen');
            
            if (backBtn && welcomeScreen && chatScreen) {
                backBtn.addEventListener('click', () => {
                    chatScreen.style.display = 'none';
                    welcomeScreen.style.display = 'block';
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö API
            const saveApiConfigBtn = document.getElementById('saveApiConfigBtn');
            if (saveApiConfigBtn) {
                saveApiConfigBtn.addEventListener('click', () => {
                    const apiKey = document.getElementById('apiKeyInput').value.trim();
                    const folderId = document.getElementById('folderIdInput').value.trim();
                    
                    if (!apiKey || !folderId) {
                        alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è!');
                        return;
                    }
                    
                    if (apiKey.length < 20) {
                        alert('API –∫–ª—é—á —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π');
                        return;
                    }
                    
                    if (!folderId.startsWith('b1g')) {
                        alert('Folder ID –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å "b1g"');
                        return;
                    }
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∫–æ–Ω—Ñ–∏–≥
                    if (!window.CONFIG) window.CONFIG = {};
                    window.CONFIG.YANDEX_API_KEY = apiKey;
                    window.CONFIG.YANDEX_FOLDER_ID = folderId;
                    window.CONFIG.MODE = 'api';
                    
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
                    apiSettingsModal.style.display = 'none';
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º UI
                    updateUIFromConfig();
                    
                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                    checkApiConnection();
                    
                    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage
                    try {
                        localStorage.setItem('mashinaConfig', JSON.stringify({
                            YANDEX_API_KEY: apiKey,
                            YANDEX_FOLDER_ID: folderId,
                            MODE: 'api'
                        }));
                    } catch (e) {
                        console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', e);
                    }
                    
                    alert('‚úÖ –ö–ª—é—á–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã! –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ø–Ω–¥–µ–∫—Å GPT.');
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–µ–º–æ-—Ä–µ–∂–∏–º"
            const useDemoBtn = document.getElementById('useDemoBtn');
            if (useDemoBtn) {
                useDemoBtn.addEventListener('click', () => {
                    if (!window.CONFIG) window.CONFIG = {};
                    window.CONFIG.MODE = 'demo';
                    
                    apiSettingsModal.style.display = 'none';
                    updateUIFromConfig();
                    checkApiConnection();
                    
                    alert('üé≠ –í–∫–ª—é—á–µ–Ω –¥–µ–º–æ-—Ä–µ–∂–∏–º');
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ–Ω–∞" –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
            const cancelApiBtn = document.getElementById('cancelApiBtn');
            if (cancelApiBtn) {
                cancelApiBtn.addEventListener('click', () => {
                    apiSettingsModal.style.display = 'none';
                });
            }
            
            // –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ"
            const testConnectionBtn = document.getElementById('testConnectionBtn');
            const testResult = document.getElementById('testResult');
            const testModal = document.getElementById('testModal');
            const testContent = document.getElementById('testContent');
            
            if (testConnectionBtn && testResult) {
                testConnectionBtn.addEventListener('click', async () => {
                    const apiKey = document.getElementById('apiKeyInput').value.trim();
                    const folderId = document.getElementById('folderIdInput').value.trim();
                    
                    if (!apiKey || !folderId) {
                        testResult.innerHTML = '<div class="error">‚ùå –ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è</div>';
                        return;
                    }
                    
                    testResult.innerHTML = '<div class="checking"><i class="fas fa-spinner fa-spin"></i> –ü—Ä–æ–≤–µ—Ä–∫–∞...</div>';
                    
                    // –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É (—Ä–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—É–¥–µ—Ç —á–µ—Ä–µ–∑ script.js)
                    setTimeout(() => {
                        if (apiKey.length > 20 && folderId.startsWith('b1g')) {
                            testResult.innerHTML = '<div class="success">‚úÖ –ö–ª—é—á–∏ –≤—ã–≥–ª—è–¥—è—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ</div>';
                        } else {
                            testResult.innerHTML = '<div class="error">‚ùå –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∫–ª—é—á–µ–π</div>';
                        }
                    }, 1500);
                });
            }
        }
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π –≥–æ–¥
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ –∏–∑ localStorage –µ—Å–ª–∏ –Ω–µ—Ç –≤ window.CONFIG
            if (!window.CONFIG) {
                try {
                    const savedConfig = localStorage.getItem('mashinaConfig');
                    if (savedConfig) {
                        window.CONFIG = JSON.parse(savedConfig);
                        console.log('‚úÖ –ö–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ localStorage');
                    }
                } catch (e) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–æ–Ω—Ñ–∏–≥–∞:', e);
                }
            }
            
            // –ï—Å–ª–∏ –≤—Å–µ —Ä–∞–≤–Ω–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–∏–≥–∞, —Å–æ–∑–¥–∞–µ–º –¥–µ–º–æ
            if (!window.CONFIG) {
                window.CONFIG = {
                    MODE: 'demo',
                    YANDEX_API_KEY: '',
                    YANDEX_FOLDER_ID: '',
                    USE_PROXY: true
                };
                console.log('üìù –°–æ–∑–¥–∞–Ω –¥–µ–º–æ-–∫–æ–Ω—Ñ–∏–≥');
            }
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            updateUIFromConfig();
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
            checkApiConnection();
            
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            setupModalHandlers();
            
            console.log('üé® UI –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
        });
        
        // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        window.updateUI = updateUIFromConfig;
        window.checkConnection = checkApiConnection;
        window.showConfig = () => window.CONFIG;
    </script>
</body>
</html>